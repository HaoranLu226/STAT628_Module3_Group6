sum(4.5,2.5,3,1,5.5,3,1,2,5.5,2.5,2,4,2,3,5.5,3,3,2,3,1,2,1,2,5,
2,3,2,2,2,4,2,2,4,2,4,1,3,3,1,2,2,3,4,2.5,2,4,3,2,2.5,1.5,1.5,
3.5,3,6)
sum(7,3,1,5.5,4,
2,8,2,4,2,3,5.5,
3,3,2,3,2,1,2,1,3,5,2,3,
2,2,2,4,2,2,4,2,4,1,3,
3,1,2,2,3,4,4.5,
4,3,2,4,5,3,6)
sum(7,3,1,5.5,4,
2,8,2,4,2,3,5.5,
3,3,2,3,2,1,2,1,3,5,2,3,
2,2,2,4,2,2,4,2,4,1,3,
3,1,2,2,3,4,4.5,
4,3,2,4,5,3,6)
sum(4.5,2.5,3,1,5.5,3,1,
2,5.5,2.5,2,4,2,3,5.5,
3,3,2,3,2,1,2,1,8,
5,2,2,2,4,2,2,4,2,4,1,3,
4,2,2,3,4,4.5,4,3,2,4,5,3,6)
M1 <- matrix(1:12, nrow = 2, ncol = 3)
M1
M1 <- matrix(1:6, nrow = 2, ncol = 3)
M1
dim(M1)
n_row <- nrow(M1)
nrow(M1)
M1 <- array(1:24,dim=c(2,3,4))
M1
tensor <- array(1:24, dim=c(2,3,4))
dim(tensor)
tensor <- array(1:120, dim=c(10,3,4))
clus <- function(tensor, num_out = 1, type ='row',thres=0.5)
{ # Tensor: 1000 * 4 * 30
# outpur: 1000 * 2 * 30
n_row <- nrow(M1)
n_col <- ncol(M1)
if type == 'col'
n_vec <- n_col
if type == 'row'
n_vec <- n_row
cor_list <- rep(0, n_col)
for(case_row = 1:n_col)
{
}
}
dim(tensor)[1]
min(10, round(n_people), n_people)
n_people <- dim(tensor)[1]
min(10, round(n_people), n_people)
tensor <- array(1:120, dim=c(100,3,4))
n_people <- dim(tensor)[1]
n_row    <- dim(tensor)[2]
n_col    <- dim(tensor)[3]
pre_cluster_size = min(10, round(n_people), n_people)
pre_cluster_size
tensor
tensor <- array(1:12, dim=c(2,3,4))
tensor
setwd("/Users/hrl/Desktop/STAT628_Module3_Group6")
library(tm)
library(SnowballC)
library(wordcloud)
library(RColorBrewer)
library(dplyr)
library(tm)
library(SnowballC)
library(wordcloud)
library(RColorBrewer)
library(dplyr)
# ------
tip <- read.csv("steakhouse_tip.csv")
head(tip)
text <- tip$text
alltext <- paste(text,sep = "", collapse = " ")
alltext <- gsub('[.]', '', alltext)
alltext <- gsub('[,]', '', alltext)
alltext <- gsub('[!]', '', alltext)
alltext <- tolower(alltext)
septext <- strsplit(alltext,split=' ')
freq_0 <- table(septext)
freq <- sort(freq_0, decreasing = TRUE)[1:100]
docs <- Corpus(VectorSource(septext))
toSpace <- content_transformer(function (x , pattern) gsub(pattern, " ", x))
docs <- tm_map(docs, toSpace, "/")
docs <- tm_map(docs, toSpace, "@")
docs <- tm_map(docs, toSpace, "\\|")
docs <- tm_map(docs, content_transformer(tolower)) # Remove numbers
docs <- tm_map(docs, removeNumbers) # Remove english common stopwords
docs <- tm_map(docs, removeWords, stopwords("english")) # Remove your own stop word
docs <- tm_map(docs, removeWords, c("blabla1", "blabla2"))  # specify your stopwords as a character vector
docs <- tm_map(docs, removePunctuation) # Remove punctuations
docs <- tm_map(docs, stripWhitespace) # Eliminate extra white spaces
dtm <- TermDocumentMatrix(docs)
m <- as.matrix(dtm)
v <- sort(rowSums(m),decreasing=TRUE)
d <- data.frame(word = names(v),freq=v)
head(d, 10)
set.seed(1234)
wordcloud(words = d$word, freq = d$freq, min.freq = 1,
max.words=200, random.order=FALSE, rot.per=0.35,
colors=brewer.pal(15, "Dark2"))
# colors <- c('red','blue','green','maroon','brown','navy','purple')
list_things <- list()
list_other <- list()
list_food$word<-c("steak","bar","sushi","cheese",
"drinks","salad","meat","chicken","beer","wine","burger","hibachi","fresh",
"specials","crab","soup","fries","shrimp","bread","cocktails","rib","onion","lobster",
"sandwich","appetizer","fish","dessert","pork","lamb","tuna","salmon",
"chips","pizza","cinnamon","oysters","calamari","bisque","gluten","pepper","pie",
"italian","cheesecake","chocolate","mushrooms","nachos")
list_food$freq <- (length(list_food$word):1)^1.5
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(12, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","bartender","patio","music","breakfast","overpriced",
"martini","clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
# colors <- c('red','blue','green','maroon','brown','navy','purple')
list_things <- list()
list_other <- list()
list_food$word<-c("steak","bar","sushi","cheese",
"drinks","salad","meat","chicken","beer","wine","burger","hibachi","fresh",
"specials","crab","soup","fries","shrimp","bread","cocktails","rib","onion","lobster",
"sandwich","appetizer","fish","dessert","pork","lamb","tuna","salmon","martini",
"chips","pizza","cinnamon","oysters","calamari","bisque","gluten","pepper","pie",
"italian","cheesecake","chocolate","mushrooms","nachos")
list_food$freq <- (length(list_food$word):1)^1.5
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(12, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(12, "Dark2"))
# colors <- c('red','blue','green','maroon','brown','navy','purple')
list_things <- list()
list_other <- list()
list_food$word<-c("steak","bar","sushi","cheese",
"drinks","salad","meat","chicken","beer","wine","burger","hibachi","fresh",
"specials","crab","soup","fries","shrimp","bread","cocktails","rib","onion","lobster",
"sandwich","appetizer","fish","dessert","pork","lamb","tuna","salmon","martini",
"chips","pizza","cinnamon","oysters","calamari","bisque","gluten","pepper","pie",
"italian","cheesecake","chocolate","mushrooms","nachos")
list_food$freq <- (length(list_food$word):1)^1.5
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(12, "Dark2"))
list_things <- list()
list_other <- list()
list_food$word<-c("steak","bar","sushi","cheese",
"drinks","salad","meat","chicken","beer","wine","burger","hibachi","fresh",
"specials","crab","soup","fries","shrimp","bread","cocktails","rib","onion","lobster",
"sandwich","appetizer","fish","dessert","pork","lamb","tuna","salmon","martini",
"chips","pizza","cinnamon","oysters","calamari","bisque","gluten","pepper","pie",
"italian","cheesecake","chocolate","mushrooms","nachos")
list_food$freq <- (length(list_food$word):1)^1.5
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
# colors <- c('red','blue','green','maroon','brown','navy','purple')
list_things <- list()
list_other <- list()
list_food$word<-c("steak","bar","sushi","cheese",
"drinks","salad","meat","chicken","beer","wine","burger","hibachi","fresh",
"specials","crab","soup","fries","shrimp","bread","cocktails","rib","onion","lobster",
"sandwich","appetizer","fish","dessert","pork","lamb","tuna","salmon","martini",
"chips","pizza","cinnamon","oysters","calamari","bisque","gluten","pepper","pie",
"italian","cheesecake","chocolate","mushrooms","nachos")
# colors <- c('red','blue','green','maroon','brown','navy','purple')
list_foods <- list()
list_other <- list()
list_food$word<-c("steak","bar","sushi","cheese",
"drinks","salad","meat","chicken","beer","wine","burger","hibachi","fresh",
"specials","crab","soup","fries","shrimp","bread","cocktails","rib","onion","lobster",
"sandwich","appetizer","fish","dessert","pork","lamb","tuna","salmon","martini",
"chips","pizza","cinnamon","oysters","calamari","bisque","gluten","pepper","pie",
"italian","cheesecake","chocolate","mushrooms","nachos")
# colors <- c('red','blue','green','maroon','brown','navy','purple')
list_food <- list()
list_other <- list()
list_food$word<-c("steak","bar","sushi","cheese",
"drinks","salad","meat","chicken","beer","wine","burger","hibachi","fresh",
"specials","crab","soup","fries","shrimp","bread","cocktails","rib","onion","lobster",
"sandwich","appetizer","fish","dessert","pork","lamb","tuna","salmon","martini",
"chips","pizza","cinnamon","oysters","calamari","bisque","gluten","pepper","pie",
"italian","cheesecake","chocolate","mushrooms","nachos")
list_food$freq <- (length(list_food$word):1)^1.5
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_food$word<-c("steak","bar","sushi",
"drinks","salad","meat","chicken","beer","cheese","wine","burger","hibachi","fresh",
"specials","crab","soup","fries","shrimp","bread","cocktails","rib","onion","lobster",
"sandwich","appetizer","fish","dessert","pork","lamb","tuna","salmon","martini",
"chips","pizza","cinnamon","oysters","calamari","bisque","gluten","pepper","pie",
"italian","cheesecake","chocolate","mushrooms","nachos")
list_food$freq <- (length(list_food$word):1)^1.5
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","bartender","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_food$word<-c("steak","bar","sushi",
"drinks","salad","meat","chicken","beer","cheese","wine","burger","hibachi","fresh",
"specials","crab","soup","fries",,"bartender","shrimp","bread","cocktails","rib","onion","lobster",
"sandwich","appetizer","fish","dessert","pork","lamb","tuna","salmon","martini",
"chips","pizza","cinnamon","oysters","calamari","bisque","gluten","pepper","pie",
"italian","cheesecake","chocolate","mushrooms","nachos")
list_food$word<-c("steak","bar","sushi",
"drinks","salad","meat","chicken","beer","cheese","wine","burger","hibachi","fresh",
"specials","crab","soup","fries","bartender","shrimp","bread","cocktails","rib","onion","lobster",
"sandwich","appetizer","fish","dessert","pork","lamb","tuna","salmon","martini",
"chips","pizza","cinnamon","oysters","calamari","bisque","gluten","pepper","pie",
"italian","cheesecake","chocolate","mushrooms","nachos")
list_food$freq <- (length(list_food$word):1)^1.5
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_food$word<-c("steak","bar","sushi",
"drinks","salad","meat","chicken","beer","cheese","wine","burger","hibachi","fresh",
"specials","crab","soup","fries","bartender","shrimp","bread","cocktails","rib","onion","lobster",
"sandwich","appetizer","fish","dessert","pork","lamb","tuna","salmon","martini",
"chips","pizza","cinnamon","oysters","calamari","bisque","gluten","pepper","pie",
"italian","cheesecake","chocolate","mushrooms","nachos")
list_food$freq <- (length(list_food$word):1)^1.5
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
wordcloud(words = list_food$word, freq = list_food$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
list_other$word<-c("service","atmosphere",
"lunch","dinner","night","wait","order","price","friendly","brunch",
"reservation", "deliver","patio","music","breakfast","overpriced",
"clean","plates","wifi")
list_other$freq <- (length(list_other$word):1)^1.2
wordcloud(words = list_other$word, freq = list_other$freq,
random.order=F,random.color=T, colors=brewer.pal(8, "Dark2"))
